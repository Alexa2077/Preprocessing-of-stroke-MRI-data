使用NIFTI_20140122工具箱进行降采样

# 1 安装工具包
**一：将要添加的工具包解压好**
我这里要添加的文件包为： NIfTI_20140122
![](587e82a18b270cb8cdaaea01410d3bf9)

**二：找到自己电脑MATLAB的安装目录，找到toolbox文件夹，将解压好的工具包复制到toolbox文件夹中**
我这里的安装目录是：E:\MATLAB\R2019a\toolbox
![](67e537a5364169ed327f8109c25e61c9)


**三：打开MATLAB程序，给新添加的工具包设置路径**
（1）**以中文版为例，在主界面找到“设置路径”按钮**

![](a1d892c0b277b409226286434bf87724)

（2）点击“**设置路径”**，弹出设置界面
第一步：点“**添加文件夹**”
（注：如果要工具包中有多个子文件夹，则点“添加并包含子文件夹”）
![](167cb99f72d53d80a7d89f96ab81de13)


 第二步：找到安装目录下toolbox中复制过来的工具包，添加

第三步：添加好文件后，MATLAB搜索路径下便会出现添加好的新工具包路径，点“保存”，再“关闭”


**四：预设**
主界面中找到”预设“按钮，点击打开，找到”常规“，点击”更新工具箱路径缓存“，再点”应用“，最后”确定“即可
![](c2520fd77f857266332290f5f1dd1759)
![](c81223eaa7473c4a3d58a6c5dce19f4e)


**五：测试**
在MATLAB命令行窗口输入： nifti
回车有输出即为工具包添加成功
![](7375553d75f56a85661ada8a5c0b5bad)

或者使用 which nifti, 有路径输出即正确
![](1c20a4c1a4a6fbab4584c6558601f3d2)

# 2 降采样
**六，NIfTI_20140122脑图谱重采样**
——数据可以4维
reslice_nii('BN_Atlas_246_1mm.nii','BN_Atlas_246_8mm.nii',8,1,0,2)

从左到右，第一个为输入图像路径，第二个为输出图像路径，第三个为重采样尺寸，这里为8，表示重采样到8mm的体素尺寸，第五个为插值方法。1：三线性插值（默认），2：最近邻插值，3：Fischer的Bresenham插值。图谱采样为了不增加一些小数，label都是整数，所以一般用最近邻插值。

本文使用如下方式：将尺寸大小**(192,24,192),分辨率为(1,1,1)**的模板和Atlas，分别降采样到**(97,113,97)(2,2,2):** 
reslice_nii('JHU_SS_b0_padding.nii.gz','JHU_SS_b0_padding_2mm.nii.gz',2,1,0,2)
% Usage: reslice_nii(old_fn, new_fn, [voxel_size], [verbose], [bg], [method], [img_idx])
reslice_nii('AspectsAtlas_padding.nii.gz','AspectsAtlas_padding_2mm.nii.gz',2,2,0,2)


如下图所示：
**模板重采样前：(192,24,192)(1,1,1)**
![](c9cf47b5cb6ac0fa1bf83c37ef2b8361)

** 模板重采样后：(97,113,97)(2,2,2)**
![](33a05d7c5878a0d0a27096548c0800c1)

**Atlas采样前：(192,24,192)(1,1,1)**
![](b7923214d1f48eb5f7194e5f86a115d2)

**Atlas重采样后：(97,113,97)(2,2,2)**
![](52b64f50d4c84e515d5dea891bb03d0c)
